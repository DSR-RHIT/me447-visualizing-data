---
title: "Table basics"
author: 'Richard Layton'
date: '`r format(Sys.time(), "%Y-%m-%d")`'
output:
  word_document:
    fig_caption: yes
    reference_docx: '../resources/word-styles-reference-01.docx'
---

```{r setup, include=FALSE}
library(knitr)
opts_knit$set(root.dir = "../")
opts_chunk$set(echo = FALSE, messages = FALSE, warning = FALSE)
```

```{r include = FALSE}
library(tidyverse)
library(pander)
```

# Make a table

```{r}
# create a subset of the mtcars data
df <- mtcars %>%
  mutate(make_model = row.names(mtcars)) %>%
  filter(near(cyl, 4)) %>%    
  select(make_model, mpg, wt) %>%
  mutate(wt = wt*1000) %>%
  arrange(desc(wt)) 
```

<br>

Here is a data frame printed with no additional formatting. 

<br>

```{r}
# just the data frame as is
print(df)
```

<br>

Here is a paragraph just before a table by `kable()`. 

<br>

```{r}
# use knitr::kable() to print a data frame as a table 
kable(df) 
```

<br>

Here is a paragraph just before a table by `pander()`. 

<br>


```{r}
# set pander table-layout options
library(pander)
panderOptions('table.alignment.default', function(df)
    ifelse(sapply(df, is.numeric), 'right', 'left'))
panderOptions('table.split.table', Inf)
panderOptions('big.mark', ",")
panderOptions('keep.trailing.zeros', TRUE)
pander(df) 
```

<br> 

## Using captioner()

```{r}
library(captioner)
# assign the prefix
auto_tab_ID <- captioner(prefix = "Table")
```

<br>

An excerpt of data from our fabulous experiment is shown in `r auto_tab_ID("a_table", display = "cite")`. 

<br>

```{r include=FALSE}
# assign the table prefix, number, and caption 
auto_tab_ID(name = "a_table", caption = "A descriptive caption for the table.")
```

```{r}
# print the table with caption
kable(df, caption = auto_tab_ID("a_table"), row.names = FALSE)
```

## a second table


```{r results = 'hide'}
# create a caption for a second table 
auto_tab_ID("another_table", "A boring table.")
```

More amazing results are shown in `r auto_tab_ID("another_table", display = "cite")`. 

```{r}
# get some data
df2 <- tail(cars, n = 5L)

# print the table with caption
kable(df2, caption = auto_tab_ID("another_table"), row.names = FALSE)
```

