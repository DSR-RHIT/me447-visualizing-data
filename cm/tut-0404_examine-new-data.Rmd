---
output: github_document
bibliography: "../manage/refs.bib" 
csl: "../manage/csl/journal-of-peace-research.csl"
---

```{r echo=FALSE}
library(knitr)
opts_knit$set(root.dir = "../")
opts_chunk$set(echo = TRUE, message = FALSE, collapse = TRUE, warning = FALSE, cache = TRUE, cache.path = "tut-04-cache/", fig.path = "tut-04-images/")
```


```{r echo=FALSE}
rm(list = (ls()))
suppressMessages(library(tidyverse))
suppressMessages(library(readxl))
```

```{r include=FALSE}
# read data from an excel file
press_calibr <- read_excel(path = "data/pressure-calibration.xlsx", sheet = "long form")

# examine the data frame
print(class(press_calibr))
glimpse(press_calibr)

# when the form is not tidy
wide_data <- read_excel(path = "data/pressure-calibration.xlsx", sheet = "wide form")
glimpse(wide_data)

# read it again, skip row 1, names in row 2, data starts in row 3
wide_data <- read_excel(path = "data/pressure-calibration.xlsx", sheet = "wide form", skip = 1)
glimpse(wide_data)

# write the data frames to CSV files
write_csv(press_calibr, "data/press-calibr-long.csv")
write_csv(wide_data, "data/press-calibr-wide.csv")

# clear the workspace
rm(list = (ls()))

# confirm that all variables are removed
ls()

press_calibr <- read_csv("data/press-calibr-long.csv")
wide_data <- read_csv("data/press-calibr-wide.csv")
# check the workspace
print(ls())
```

## examining a data set  

Whenever you read a new data set, examine it a number of ways to be certain you know what you have. 

In the previous tutorial, we read the CSV files   *press-calibr-long.csv* and *press-calibr-long.csv*. 

```{r}
press_calibr <- read_csv("data/press-calibr-long.csv")
wide_data    <- read_csv("data/press-calibr-wide.csv")
```

Check its class; we usually want a data frame. 

```{r}
# examine the data frame
class(press_calibr)
```

It is a data frame (as well as class *tbl* and *tbl_df* which make for better printing).

Next, from the tidyverse *tibble* package, use the *glimpse()* function to determine the number of variables (columns), the number of observations (rows), the variable names (column names), the variable types (integer, character, double-precision, logical, etc.), and as much data as possible. 

```{r}
glimpse(press_calibr)
```

Because the data frame is of the *tibble* class, just type its name to print the first 10 rows. 

```{r}
# print a tibble
press_calibr
```

Otherwise, you can use *head()* to see the first few rows or *tail()* to examine the last few rows (here, n = 10 rows). 

```{r}
# look at the last 10 rows
tail(press_calibr, n = 10L)
```

## missing values

In R, missing values are represented by the symbol NA (not available).

The simplest check is *summary()*, then look for any variables with NAs. In this case, the long-form data set has no missing variables, so there are no NAs identified. 

```{r}
# a data frame with no missing values 
summary(press_calibr)
```

Look at the summary of *wide_data*. The variables  *cycle 1* and *cycle 6* have missing values (NA's). 

```{r}
# data frame that has missing values
summary(wide_data)
```

The *VIM* package has a function *aggr()* (aggregate missing values) that calculates the number of missing values and plots the results. These results show that 12 rows are missing entries in *cycle 6* only, 3 rows are missing data in *cycle 1* only, and 1 row has no missing values. 

```{r}
# a package for summarizing missing values 
library(VIM)
aggr_plot <- aggr(
	wide_data
	, numbers  = TRUE
	, sortVars = TRUE
	, prop     = FALSE
	, combined = TRUE
	, ylab     = "Pattern of missing values"
	)
```

Below the graph, *aggr()* produces an output that summarizes the numbers shown in the plot. 

```{r include-FALSE}
unloadNamespace("VIM")
```




Next tutorial: [when a new library masks other functions](tut-0405_new-library-masks.md)

---

[main page](../README.md)<br> 
[topics page](../README-by-topic.md)



