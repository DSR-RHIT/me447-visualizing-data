---
output: github_document
bibliography: "../manage/refs.bib" 
csl: "../manage/csl/journal-of-peace-research.csl"
---

```{r echo=FALSE}
library(knitr)
opts_knit$set(root.dir = "../")
opts_chunk$set(echo = TRUE, message = FALSE, collapse = TRUE, warning = FALSE, cache = TRUE, cache.path = "tut-04-cache/02-", fig.path = "tut-04-images/02-")
```

```{r echo=FALSE}
rm(list = (ls()))
suppressPackageStartupMessages(library(tidyverse))
library(readxl)
```


## examine the sample Excel file 

On your local machine 

- Open *pressure-calibration.xlsx* in Excel.
- Take a look at the two worksheets (tabs). Note how they differ. 

One worksheet shows the data in *wide form*, great for human readability; the other shows the data in *long form*, what we want for making graphs. In this activity we'll use the long form. 

- Close the Excel file 

## read tidy data from an Excel file

From the *readxl* package, use *read_excel()*.

If the Excel file has column names in the first row and data in the remaining rows, then we need only specify the path to the file and the name of the worksheet (tab). 

```{r}
# read data from an excel file
press_calibr <- read_excel(
	path = "data/pressure-calibration.xlsx"
	, sheet = "long form"
	)
```

Determine the *class* of the *press_calibr* R object we made. 

```{r}
# examine the data
print(class(press_calibr))
```

Among the classes listed is *data.frame*, which is what we want for most of our data manipulation and graph tasks. If *press_calibr* were not a data frame, we would want to coerce it to one using *y <- as.data.frame(x)*.

From the *tidyverse* package, use *glimpse()* to see the elements of the data frame. 

```{r}
glimpse(press_calibr)
```

## read slightly untidy Excel data

The spreadsheet tab *wide form* contains the same calibration in wide form. If we read this tab like we did the other tab, we get the following, 
```{r}
# when the form is not tidy
wide_data <- read_excel(
	path = "data/pressure-calibration.xlsx"
	, sheet = "wide form"
	)

# examine the result
glimpse(wide_data)
```

Note that variable names *X_1*, *X_2*, etc., were created by *read_excel* because the first row of the spreadsheet was blank except for column 3, *readingPSI*. Consequently the column names we would like to use were assigned to the first row of data and that meant that all the data were coerced to be character data, not numerical.  

We use the *skip* argument to skip the first row of the spreadsheet, then the second row is treated as if it held the variable names, and row 3 is the first row of data. 

```{r}
# read it again, skip row 1
wide_data <- read_excel(
	path = "data/pressure-calibration.xlsx"
	, sheet = "wide form"
	, skip = 1
	)

# examine the result
glimpse(wide_data)
```

These data are still in wide form, but are ready for further data carpentry.  

Next tutorial: [read and write CSV files](tut-0403_read-write-csv.md)

---

[main page](../README.md)<br> 
[topics page](../README-by-topic.md)



